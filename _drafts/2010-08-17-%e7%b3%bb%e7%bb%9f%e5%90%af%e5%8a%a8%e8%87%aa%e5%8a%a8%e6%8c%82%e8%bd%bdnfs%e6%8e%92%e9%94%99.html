---
layout: post
status: publish
published: true
title: "系统启动自动挂载NFS排错"
author:
  display_name: Ninjacn
  login: admin
  email: x@ninjacn.com
  url: ''
author_login: admin
author_email: x@ninjacn.com
wordpress_id: 918
wordpress_url: http://ninjacn.com/?p=918
date: '2010-08-17 16:45:01 +0800'
date_gmt: '2010-08-17 08:45:01 +0800'
categories:
- Server
tags:
- linux
- mount
- nfs
- sleep
comments:
- id: 285
  author: '1111'
  author_email: 1111@1111.com
  author_url: ''
  date: '2010-08-25 09:26:57 +0800'
  date_gmt: '2010-08-25 01:26:57 +0800'
  content: "但你要看服务器启动时间要比交换机还要长"
- id: 286
  author: ming
  author_email: x@ninjacn.com
  author_url: ''
  date: '2010-08-25 09:51:09 +0800'
  date_gmt: '2010-08-25 01:51:09 +0800'
  content: "主要是思科的交换机不是即插即用吧，它得有个初始化阶段，是针对每个端口的。服务器的网络服务启动后经过的时间跟交换机端口初始化时间相匹配就没有问题了"
---
<p>故障分析：</p>
<p>客户机挂载NFS服务器，手动执行命令或脚本都能正常挂载，但就是写进启动脚本&#47;etc&#47;rc.local尽然不起任何作用。通过输出各种信息显示，在执行&#47;etc&#47;rc.local之前路由表是正常的，但两个网卡都不能发出数据，提示目标不可达。但NETWORK服务的确是起来的。当然更不可能是防火墙的原因，因为手动执行不存在任何问题。排除了系统的原因以后，才发现交换机有些问题，CISCO交换机在网络服务启动起来以后，要经过近30秒到一分钟才能正常连接。问题原因找到就好办多 了。。</p>
<p>解决办法：</p>
<p>在挂载mount命令执行之前，加sleep,等待一点时间再mount，即可正常</p>
<p>我写脚本等了1分钟：sleep 60&nbsp;&nbsp; 单位默认是秒。</p>
